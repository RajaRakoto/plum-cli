!function(t){"undefined"!=typeof define&&define.amd?define([],t):"undefined"!=typeof module&&module.exports?module.exports=t():window.scrollMonitor=t()}(function(){function t(){return window.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop}function i(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight)}var o,u,e,s,n,w={},h=[],m="visibilityChange",d="enterViewport",f="fullyEnterViewport",b="exitViewport",v="partiallyExitViewport",g="locationChange",V="stateChange",y=[m,d,f,b,v,g,V],I={top:0,bottom:0},c=function(){return window.innerHeight||document.documentElement.clientHeight};function l(){if(w.viewportTop=t(),w.viewportBottom=w.viewportTop+w.viewportHeight,w.documentHeight=i(),w.documentHeight!==o){for(e=h.length;e--;)h[e].recalculateLocation();o=w.documentHeight}}function r(){w.viewportHeight=c(),l(),p()}function a(){clearTimeout(s),s=setTimeout(r,100)}function p(){for(n=h.length;n--;)h[n].update();for(n=h.length;n--;)h[n].triggerCallbacks()}function k(t,i){var o=this;this.watchItem=t,this.offsets=i?i===+i?{top:i,bottom:i}:{top:i.top||I.top,bottom:i.bottom||I.bottom}:I,this.callbacks={};for(var e,s,n,h,c,l,r=0,a=y.length;r<a;r++)o.callbacks[y[r]]=[];function p(t){if(0!==t.length)for(c=t.length;c--;)(l=t[c]).callback.call(o,u),l.isOne&&t.splice(c,1)}this.locked=!1,this.triggerCallbacks=function(){switch(this.isInViewport&&!e&&p(this.callbacks[d]),this.isFullyInViewport&&!s&&p(this.callbacks[f]),this.isAboveViewport!==n&&this.isBelowViewport!==h&&(p(this.callbacks[m]),s||this.isFullyInViewport||(p(this.callbacks[f]),p(this.callbacks[v])),e||this.isInViewport||(p(this.callbacks[d]),p(this.callbacks[b]))),!this.isFullyInViewport&&s&&p(this.callbacks[v]),!this.isInViewport&&e&&p(this.callbacks[b]),this.isInViewport!==e&&p(this.callbacks[m]),!0){case e!==this.isInViewport:case s!==this.isFullyInViewport:case n!==this.isAboveViewport:case h!==this.isBelowViewport:p(this.callbacks[V])}e=this.isInViewport,s=this.isFullyInViewport,n=this.isAboveViewport,h=this.isBelowViewport},this.recalculateLocation=function(){var t,i,o,e;this.locked||(t=this.top,i=this.bottom,this.watchItem.nodeName?("none"===(o=this.watchItem.style.display)&&(this.watchItem.style.display=""),e=this.watchItem.getBoundingClientRect(),this.top=e.top+w.viewportTop,this.bottom=e.bottom+w.viewportTop,"none"===o&&(this.watchItem.style.display=o)):this.watchItem===+this.watchItem?0<this.watchItem?this.top=this.bottom=this.watchItem:this.top=this.bottom=w.documentHeight-this.watchItem:(this.top=this.watchItem.top,this.bottom=this.watchItem.bottom),this.top-=this.offsets.top,this.bottom+=this.offsets.bottom,this.height=this.bottom-this.top,void 0===t&&void 0===i)||this.top===t&&this.bottom===i||p(this.callbacks[g])},this.recalculateLocation(),this.update(),e=this.isInViewport,s=this.isFullyInViewport,n=this.isAboveViewport,h=this.isBelowViewport}w.viewportTop=null,w.viewportBottom=null,w.documentHeight=null,w.viewportHeight=c(),k.prototype={on:function(t,i,o){switch(!0){case t===m&&!this.isInViewport&&this.isAboveViewport:case t===d&&this.isInViewport:case t===f&&this.isFullyInViewport:case t===b&&this.isAboveViewport&&!this.isInViewport:case t===v&&this.isAboveViewport:if(i.call(this,u),o)return}if(!this.callbacks[t])throw new Error("Tried to add a scroll monitor listener of type "+t+". Your options are: "+y.join(", "));this.callbacks[t].push({callback:i,isOne:o||!1})},off:function(t,i){if(!this.callbacks[t])throw new Error("Tried to remove a scroll monitor listener of type "+t+". Your options are: "+y.join(", "));for(var o,e=0;o=this.callbacks[t][e];e++)if(o.callback===i){this.callbacks[t].splice(e,1);break}},one:function(t,i){this.on(t,i,!0)},recalculateSize:function(){this.height=this.watchItem.offsetHeight+this.offsets.top+this.offsets.bottom,this.bottom=this.top+this.height},update:function(){this.isAboveViewport=this.top<w.viewportTop,this.isBelowViewport=this.bottom>w.viewportBottom,this.isInViewport=this.top<=w.viewportBottom&&this.bottom>=w.viewportTop,this.isFullyInViewport=this.top>=w.viewportTop&&this.bottom<=w.viewportBottom||this.isAboveViewport&&this.isBelowViewport},destroy:function(){var t=h.indexOf(this);h.splice(t,1);for(var i=0,o=y.length;i<o;i++)this.callbacks[y[i]].length=0},lock:function(){this.locked=!0},unlock:function(){this.locked=!1}};for(var H=0,E=y.length;H<E;H++){var T=y[H];k.prototype[T]=function(o){return function(t,i){this.on.call(this,o,t,i)}}(T)}try{l()}catch(t){try{window.$(l)}catch(t){throw new Error("If you must put scrollMonitor in the <head>, you must use jQuery.")}}function B(t){u=t,l(),p()}return window.addEventListener?(window.addEventListener("scroll",B),window.addEventListener("resize",a)):(window.attachEvent("onscroll",B),window.attachEvent("onresize",a)),w.beget=w.create=function(t,i){"string"==typeof t?t=document.querySelector(t):t&&0<t.length&&(t=t[0]);t=new k(t,i);return h.push(t),t.update(),t},w.update=function(){u=null,l(),p()},w.recalculateLocations=function(){w.documentHeight=0,w.update()},w});